sys_exec = sys.executable
sys_path = str(sys.path)
cwd = os.getcwd()

# https://chrisyeh96.github.io/2017/08/08/definitive-guide-python-imports.html#absolute-vs-relative-import
print("Import INSANITY, cwd:        " + cwd)  # chrisyeh@cs.stanford.edu
# print("Import INSANITY, sys_exec: " + sys_exec)  # its the venv python bin
print("Import INSANITY, sys_path: " + sys_path)

'''Works in pycharm
Import INSANITY, cwd:        /Users/val/python/vsc/logic-explore
Import INSANITY, sys_path: ['/Users/val/python/vsc/logic-explore/nw/nw_logic', ...
'''

'''fails in vsc using config.cwd=${workspaceFolder}, BUT same as pycharm!!
Import INSANITY, cwd:        /Users/val/python/vsc/logic-explore
Import INSANITY, sys_path: ['/Users/val/python/vsc/logic-explore/nw/nw_logic', ...
'''

''' fails as script:
Import INSANITY, cwd:        /Users/val/python/vsc/logic-explore/nw/nw_logic
Import INSANITY, sys_path: ['/Users/val/python/vsc/logic-explore/nw/nw_logic',
                '/Users/val/.pyenv/versions/3.8.3/lib/python38.zip',
                '/Users/val/.pyenv/versions/3.8.3/lib/python3.8',
                '/Users/val/.pyenv/versions/3.8.3/lib/python3.8/lib-dynload',
                '/Users/val/python/vsc/logic-explore/venv/lib/python3.8/site-packages']
'''

from logic_engine import logic  # see .env file (or pycharm Add Content Roots)


update orderdetail set amount = unitPrice * quantity

update "Order" set AmountTotal =
(select sum(orderdetail.amount) from orderdetail where orderdetail.orderid = "Order".id);

select id, amounttotal from "Order" where id = 11077;

update Customer set Balance =
(select sum("Order".amounttotal) from "Order" where Customer.id = "Order".customerid
and "Order".shippeddate is null);

update Customer set Balance = 0 where balance is null;

update Customer set creditlimit = balance + 100;

830 orders, 21 not shipped
    11045 for BOTTM (22607.7 ==> 1309.5)
    ALFKI has balance=0

select id, balance, creditlimit from customer where id="BOTTM";

ALFKI 6 Orders

CREATE TABLE IF NOT EXISTS "OrderX"
(
  "Id" INTEGER PRIMARY KEY AUTOINCREMENT,
  "CustomerId" VARCHAR(8000) NULL,
  "EmployeeId" INTEGER NOT NULL,
  "OrderDate" VARCHAR(8000) NULL,
  "RequiredDate" VARCHAR(8000) NULL,
  "ShippedDate" VARCHAR(8000) NULL,
  "ShipVia" INTEGER NULL,
  "Freight" DECIMAL NOT NULL,
  "ShipName" VARCHAR(8000) NULL,
  "ShipAddress" VARCHAR(8000) NULL,
  "ShipCity" VARCHAR(8000) NULL,
  "ShipRegion" VARCHAR(8000) NULL,
  "ShipPostalCode" VARCHAR(8000) NULL,
  "ShipCountry" VARCHAR(8000) NULL, AmountTotal Decimal,
  FOREIGN KEY (CustomerId) REFERENCES Customer(Id)
);

INSERT INTO OrderX SELECT * FROM "Order";

ALTER TABLE "Order" RENAME TO OrderTemp;
ALTER TABLE "OrderX" RENAME TO "Order";

CREATE TABLE IF NOT EXISTS "OrderDetailX"
(
  "Id" VARCHAR(8000) PRIMARY KEY,
  "OrderId" INTEGER NOT NULL,
  "ProductId" INTEGER NOT NULL,
  "UnitPrice" DECIMAL NOT NULL,
  "Quantity" INTEGER NOT NULL,
  "Discount" DOUBLE NOT NULL , Amount Decimal,
  FOREIGN KEY (OrderId) REFERENCES "Order"("Id"),
  FOREIGN KEY (ProductId) REFERENCES Product("Id")
);

INSERT INTO OrderDetailX SELECT * FROM OrderDetail;
